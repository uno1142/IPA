## 関数を使って集計する

SQLにはデータを取り出す際に集計を行うさまざまな関数（集合関数）が用意されている。  

- MAX
- MIN
- AVG
- SUM
- COUNT

## データのグループ化

`GROUP BY 列名`でグループ化することができる。  
例)
```
SELECT 分類,COUNT(*)
FROM 商品分類表
GROUP BY 分類;  
```
これで商品分類表のなかの分類と商品数のグループを作り，分類ごとの商品数を数え上げることができる。


## グループに条件をつけて絞り込む

```
GROUP BY 列名
HAVING 絞り込み条件;
```

で取り出すグループを絞り込むことができる。  


# 副問合せ

SELECT文のなかにSELECT文を埋め込んで，入れ子状態で用いることを副問合せという。  

## INを用いた副問合せ

```
SELECT * FROM 社員表
WHERE 部署 = (SELECT 部署 FROM 社員表 WHERE 名前 = 'Aさん');
```

この時，上の例のように副問合せの返す行が1つであれば，演算子には比較演算子を使うことができる。  
しかし複数の行が返される場合だと，これではエラーになってしまう。  
(たとえば同姓同名で別部署に人がいた場合にエラーが出る)  

このように，複数の行が対象になる場合は`=`の部分にINを用いる。  

INを用いた副問合せでは，一度副問合せの結果として値リストが作成されてから，メインのSELECT文が実行されるという流れになる  


## EXISTSを用いた副問合せ

EXISTSは存在チェックを行う。副問合せの結果として抽出される行の有無をチェックし，あればtrue,なければfalseを返す。  
EXISTSは通常相関副問合せに用いられる。

流れとしては1行ずつ取り出して副問合せを実行し，その結果に応じて主問合せが出力したりしなかったりする。

#### 相関副問合せ

相関副問合せとは，副問合せの括弧内と外側とで共通の表を用いて行う問合せのこと。 




