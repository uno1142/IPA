# IPアドレス

IPアドレスはネットワークの住所。32bitの数値で表され、8bitごとに区切ってそれぞれを10進数で表記し、それらを`.`でつないで表記する。  

IPアドレスにはグローバルIPアドレスとプライベートIPアドレスの２種類がある。 
グローバルIPアドレスはインターネットの世界で使用するIPアドレスで、世界中で一意であることが保証されないといけないので  
地域ごとのNIC(Network Information Center)と呼ばれる民間の非営利機関によって管理されている。  

プライベートIPアドレスは企業内などLANの中でつかえるIPアドレス。LAN内で重複がなければシステム管理者が自由に割り当てて使うことができる。  

## ネットワーク部とホスト部

IPアドレスの内容はネットワークごとに分かれるネットワークアドレス部と、そのネットワーク内でコンピュータを識別するためのホストアドレス部とに分かれている。  
先頭のNビットがネットワークアドレス、後ろ32-Nビットがホストアドレスを表している。  

## クラス

IPアドレスは使用するネットワークの規模によってクラスA、クラスB、クラスCと3つのクラスに分かれている。(一般的な場合)   

- クラスA… 0.0.0.0 ~ 127.255.255.255
大規模ネットワーク用。割り当て可能ホスト：16,777,214台　先頭bitは0と決まっている。
- クラスB… 128.0.0.0 ~ 191.255.255.255
中規模ネットワーク用。割り当て可能ホスト：65,534台　先頭2bitが10と決まっている。
- クラスC… 192.0.0.0 ~ 233.255.255.255
小規模ネットワーク用。割り当て可能ホスト：254台　先頭3bitが110と決まっている。

ホストアドレス部がすべて0または1になるアドレスはそれぞれ「ネットワークアドレス(0)」「ブロードキャストアドレス(1)」という意味で  
予約されているため、割り当てには使えない。そのため割り当て可能ホスト数がそのbitで表せる数-2になっている。  

## MACアドレスとIPアドレスの変換

MACアドレスの管理は各端末に任されているため、送信先のIPアドレスはわかるがMACアドレスはわからないという場合が起こりうる。  
この時に用いるプロトコルがARP(Address Resolution Protocol)である。  
ARPではARP要求パケットをブロードキャストして、目的の端末からMACアドレスを取得する。  

一方MACアドレスからIPアドレスを取得するために用いるのがRARP(Reverse Address Resolution Protocol)。  
こちらは自身のMACアドレスをRARP要求フレームにセットして流し、RARPサーバから返答を受け取る。  


## DHCP

DHCP(Dynamic Host Configuration Protocol)というプロトコルを利用すると、IPアドレスの割り当てなどといったネットワークの設定作業を自動化することができる。  
プロバイダなどのインターネット接続サービスを利用する場合にも最初にDHCPを使ってインターネット上でのネットワーク設定を取得する手順が一般的。

## NATとIPマスカレード

LANの中ではプライベートIPアドレスを使うのが一般的だが、外のネットワークとやり取りするにはグローバルIPアドレスが必要。  
プライベートIPアドレスしか持たない各コンピュータが外のコンピュータと通信を行うには、アドレス変換技術が必要になる。  
代表的なものがNATやIPマスカレード。

### NAT
グローバルIPアドレスとプライベートIPアドレスとを１対１で結び付けて、相互に変換を行う。同時にインターネット接続できるのはグローバルIPアドレスの個数分だけ。  

### IPマスカレード

グローバルIPアドレスに複数のプライベートIPアドレスを結び付け、1対複数の変換を行う。1つのグローバルIPアドレスでも複数のコンピュータが同時にインターネット接続できる。  

